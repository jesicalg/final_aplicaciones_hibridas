
<%- include('../template/header') -%> 

    <main class="container my-5">

        <form action="/vinos/busqueda" method="post" enctype="application/x-www-form-urlencoded"  class="input-group mb-3" id="form_busqueda">
            <input type="search" name="nombre" class="form-control" placeholder="Buscar un vino" aria-label="Buscar un vino" aria-describedby="buscar" >
            <button class="btn btn-outline-secondary" type="submit" id="buscar">Buscar</button>
        </form>

        <%if(search){%>
        <section class="my-5">
            
                
            <h3 class="text-muted fs-5 mb-3">Resultados de búsqueda "<%=busqueda%>"</h3>
            <%if(vinos==""){%> 
                <p><%=message%></p>
            <%}else{%>
            <ul class="p-0">
            
            <% for(let i = 0; i < vinos.length; i++){%>
                <!--Dentro de este ul se imprime cada resultado de busqueda, un li por c/u-->
                <li class="card mb-3" style="max-width: 540px;">
                    <div class="row g-0 align-items-center">
                        <div class="col-4 col-md-4">
                            <img src="/img/vinos/750px/<%=vinos[i].img%>" class="img-fluid rounded-start mx-auto d-block img-max-w-36" alt="<%=vinos[i].nombre%>" >
                        </div>
                    <div class="col-8 col-md-8">
                        <div class="card-body">
                            <h4 class="card-title fs-5"><%=vinos[i].nombre%></h4>
                            <p class="card-text fs-5"><%=vinos[i].bodega%></p>
                            <p class="card-text"><small class="text-muted">Puntuación: <%=vinos[i].puntuacion%> estrellas</small></p>
                            <a href="/vinos/<%=vinos[i]._id%>" class="card-text"><small class="text-muted">ver más</small></a>
                        </div>
                        </div>
                    </div>
                </li>
        
            <%}%>
            </ul>
             <%}%>
        </section>
        <%}%>  

       
    </main>

    <%- include('../template/footer') -%> 

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>
    <script>

        document.getElementById('busqueda').classList.add('active');
        
        window.addEventListener('submit', validator)
        function validator(e){

            let inputSearch = document.querySelector('input[type="search"]')
            if(!inputSearch.value){
                e.preventDefault();
            }
        }
    </script>